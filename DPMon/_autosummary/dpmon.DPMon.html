<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dpmon.DPMon &mdash; DPMon  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="dpmon" href="dpmon.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            DPMon
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="dpmon.html">dpmon</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">dpmon.DPMon</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dpmon.DPMon"><code class="docutils literal notranslate"><span class="pre">DPMon</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dpmon.DPMon.__init__"><code class="docutils literal notranslate"><span class="pre">DPMon.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dpmon.DPMon.flow_feature"><code class="docutils literal notranslate"><span class="pre">DPMon.flow_feature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dpmon.DPMon.user_count_specific"><code class="docutils literal notranslate"><span class="pre">DPMon.user_count_specific()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dpmon.DPMon.volume_historam"><code class="docutils literal notranslate"><span class="pre">DPMon.volume_historam()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dpmon.DPMon.volume_historam_specific"><code class="docutils literal notranslate"><span class="pre">DPMon.volume_historam_specific()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dpmon.DPMon.volume_on_asn"><code class="docutils literal notranslate"><span class="pre">DPMon.volume_on_asn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dpmon.DPMon.volume_on_domain"><code class="docutils literal notranslate"><span class="pre">DPMon.volume_on_domain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dpmon.DPMon.volume_on_domain_pattern"><code class="docutils literal notranslate"><span class="pre">DPMon.volume_on_domain_pattern()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dpmon.DPMon.volume_on_ip"><code class="docutils literal notranslate"><span class="pre">DPMon.volume_on_ip()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dpmon.html#dpmon.DPMon"><code class="docutils literal notranslate"><span class="pre">DPMon</span></code></a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DPMon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="dpmon.html">dpmon</a></li>
      <li class="breadcrumb-item active">dpmon.DPMon</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/dpmon.DPMon.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dpmon-dpmon">
<h1>dpmon.DPMon<a class="headerlink" href="#dpmon-dpmon" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="dpmon.DPMon">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dpmon.</span></span><span class="sig-name descname"><span class="pre">DPMon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accountant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'local'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'outgoing'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ipasn_db</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dpmon.DPMon" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The main class for DPMon. Create on object of the DPMon class to make private queries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – The path do the data to be analyzed. Can be a string. When using the <code class="docutils literal notranslate"><span class="pre">local</span></code> engine, <code class="docutils literal notranslate"><span class="pre">path</span></code> can be a list of paths. When using the <code class="docutils literal notranslate"><span class="pre">spark</span></code> engine, the path is in the Spark format, thus can include <code class="docutils literal notranslate"><span class="pre">*</span></code> and <code class="docutils literal notranslate"><span class="pre">{...}</span></code> expression</p></li>
<li><p><strong>data_format</strong> (<em>str</em>) – Must specify the data format: <code class="docutils literal notranslate"><span class="pre">tstat</span></code> of <code class="docutils literal notranslate"><span class="pre">nfdump</span></code></p></li>
<li><p><strong>accountant</strong> (<em>diffprivlib.BudgetAccountant</em>) – A DiffPrivLib <code class="docutils literal notranslate"><span class="pre">BudgetAccountant</span></code> that specifies the privacy budget to limit the information it is possible to extract from the data. Create, for example, with: <code class="docutils literal notranslate"><span class="pre">diffprivlib.BudgetAccountant(epsilon=1.0)</span></code></p></li>
<li><p><strong>engine</strong> (<em>str</em>) – Engine to be used: <code class="docutils literal notranslate"><span class="pre">local</span></code> or <code class="docutils literal notranslate"><span class="pre">spark</span></code>.
Default: <code class="docutils literal notranslate"><span class="pre">&quot;local&quot;</span></code></p></li>
<li><p><strong>spark</strong> (<em>spark.sql.SparkSession</em>) – In case <code class="docutils literal notranslate"><span class="pre">engine</span> <span class="pre">=</span> <span class="pre">&quot;spark&quot;</span></code>, you must provide a <code class="docutils literal notranslate"><span class="pre">SparkSession</span></code> as a Spark entrypoint.
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>direction</strong> (<em>str</em>) – Whether to focus on <code class="docutils literal notranslate"><span class="pre">outgoing</span></code> flows (those issued by internal clients to the Internet) or <code class="docutils literal notranslate"><span class="pre">ingoing</span></code> flows (those issued by any Internet endpoint towards an internal client). See documentation for an explaination.
Default: <code class="docutils literal notranslate"><span class="pre">&quot;outgoing&quot;</span></code></p></li>
<li><p><strong>ipasn_db</strong> (<em>str</em>) – the path of a file in <code class="docutils literal notranslate"><span class="pre">pyasn</span></code> format, used to map IP addresses to the corresponding ASN. If the file is provided, it is possible to make queries based on ASN - e.g., the volume to a specific ASN.
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>head</strong> (<em>int</em>) – Truncate the data to <code class="docutils literal notranslate"><span class="pre">head</span></code> lines. Useful for debugging.
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dpmon.DPMon.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accountant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'local'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'outgoing'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ipasn_db</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dpmon.DPMon.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor method</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="dpmon.DPMon.flow_feature">
<span class="sig-name descname"><span class="pre">flow_feature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dpmon.DPMon.flow_feature" title="Permalink to this definition"></a></dt>
<dd><p>Extract statistics on a flow feature (i.e., a log’s column).
Notice that this can be used only with Tstat data and on a subset of columns.
Notice that DPMon first computes the average per-user value of the flow features.
Then it applies the requested statistic (mean, standard deviation or percentile) among the average per-user value.
This behavior is mandatory as Differential Privacy must protect users (not flows).
You can filter by server IP, ASN or Domain.
The three filters are considered together (i.e., they form an AND clause).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature</strong> (<em>str</em>) – The flow feature to compute statistics on.</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – The metric to compute. Can be <code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">std</span></code>, <code class="docutils literal notranslate"><span class="pre">histogram</span></code> or <code class="docutils literal notranslate"><span class="pre">percentile</span></code></p></li>
<li><p><strong>percent</strong> (<em>float</em>) – The percentile to compute in case <code class="docutils literal notranslate"><span class="pre">metric==percentile</span></code></p></li>
<li><p><strong>ip</strong> (<em>str</em>) – The server IP to filter. 
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>asn</strong> (<em>int</em>) – The server ASN to filter. 
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>domain</strong> (<em>str</em>) – The server domain to filter. 
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – The privacy budget to allocate for the query. Default: <code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></li>
<li><p><strong>bins</strong> (<em>int</em>) – Number of bins of the histogram in case <code class="docutils literal notranslate"><span class="pre">metric==histogram</span></code>. .
Default: <code class="docutils literal notranslate"><span class="pre">10</span></code></p></li>
<li><p><strong>range</strong> (<em>(</em><em>float</em><em>,</em><em>float</em><em>)</em>) – The lower and upper range of the bins of the histogram in case <code class="docutils literal notranslate"><span class="pre">metric==histogram</span></code>. 
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The desired statistic</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dpmon.DPMon.user_count_specific">
<span class="sig-name descname"><span class="pre">user_count_specific</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dpmon.DPMon.user_count_specific" title="Permalink to this definition"></a></dt>
<dd><p>Compute a the number of users on given server IP, domain or ASN.
In other words, it computes the number of users who, at least once, issued a flow to the an enpoint with the given characteristics.
The three filters are considered together (i.e., they form an AND clause).
It returns the number of user matching and the number of user non matching the filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ip</strong> (<em>str</em>) – The server IP to filter. 
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>asn</strong> (<em>int</em>) – The server ASN to filter. 
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>domain</strong> (<em>str</em>) – The server domain to filter. 
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – The privacy budget to allocate for the query. Default: <code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(a,</span> <span class="pre">b)</span></code>, where <code class="docutils literal notranslate"><span class="pre">a</span></code> is the number of users who never matched the filter and  <code class="docutils literal notranslate"><span class="pre">n</span></code> the number of users who did at least once.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dpmon.DPMon.volume_historam">
<span class="sig-name descname"><span class="pre">volume_historam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ingoing'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dpmon.DPMon.volume_historam" title="Permalink to this definition"></a></dt>
<dd><p>Compute a histogram of the per-user traffic volume</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume_direction</strong> (<em>str</em>) – Whether to compute ingress (<code class="docutils literal notranslate"><span class="pre">&quot;ingoing&quot;</span></code>) or egress (<code class="docutils literal notranslate"><span class="pre">&quot;outgoing&quot;</span></code>) volume, in bytes.
Default: <code class="docutils literal notranslate"><span class="pre">&quot;ingoing&quot;</span></code></p></li>
<li><p><strong>count_flows</strong> (<em>bool</em>) – Count the number of flows instead of volume. If set, <code class="docutils literal notranslate"><span class="pre">&quot;volume_direction&quot;</span></code> is ignored.
Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>bins</strong> (<em>int</em>) – Number of bins of the histogram.
Default: <code class="docutils literal notranslate"><span class="pre">10</span></code></p></li>
<li><p><strong>range</strong> (<em>(</em><em>float</em><em>,</em><em>float</em><em>)</em>) – The lower and upper range of the bins. 
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – The privacy budget to allocate for the query. Default: <code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(histo,</span> <span class="pre">bin_edges)</span></code>, where <code class="docutils literal notranslate"><span class="pre">histo</span></code> is the histogram and  <code class="docutils literal notranslate"><span class="pre">bin_edges</span></code> the boundaries</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dpmon.DPMon.volume_historam_specific">
<span class="sig-name descname"><span class="pre">volume_historam_specific</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ingoing'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dpmon.DPMon.volume_historam_specific" title="Permalink to this definition"></a></dt>
<dd><p>Compute a histogram of the per-user traffic volume on given server IP, domain or ASN.
The three filters are considered together (i.e., they form an AND clause).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume_direction</strong> (<em>str</em>) – Whether to compute ingress (<code class="docutils literal notranslate"><span class="pre">&quot;ingoing&quot;</span></code>) or egress (<code class="docutils literal notranslate"><span class="pre">&quot;outgoing&quot;</span></code>) volume, in bytes.
Default: <code class="docutils literal notranslate"><span class="pre">&quot;ingoing&quot;</span></code></p></li>
<li><p><strong>count_flows</strong> (<em>bool</em>) – Count the number of flows instead of volume. If set, <code class="docutils literal notranslate"><span class="pre">&quot;volume_direction&quot;</span></code> is ignored.
Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>bins</strong> (<em>int</em>) – Number of bins of the histogram.
Default: <code class="docutils literal notranslate"><span class="pre">10</span></code></p></li>
<li><p><strong>range</strong> (<em>(</em><em>float</em><em>,</em><em>float</em><em>)</em>) – The lower and upper range of the bins. 
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>ip</strong> (<em>str</em>) – The server IP to filter. 
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>asn</strong> (<em>int</em>) – The server ASN to filter. 
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>domain</strong> (<em>str</em>) – The server domain to filter. 
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – The privacy budget to allocate for the query. Default: <code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(histo,</span> <span class="pre">bin_edges)</span></code>, where <code class="docutils literal notranslate"><span class="pre">histo</span></code> is the histogram and  <code class="docutils literal notranslate"><span class="pre">bin_edges</span></code> the boundaries</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dpmon.DPMon.volume_on_asn">
<span class="sig-name descname"><span class="pre">volume_on_asn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ingoing'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dpmon.DPMon.volume_on_asn" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the traffic volume to/from a specific Autonomous System</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>asn</strong> (<em>int</em>) – The AS number to query</p></li>
<li><p><strong>volume_direction</strong> (<em>str</em>) – Whether to compute ingress (<code class="docutils literal notranslate"><span class="pre">&quot;ingoing&quot;</span></code>) or egress (<code class="docutils literal notranslate"><span class="pre">&quot;outgoing&quot;</span></code>) volume, in bytes.
Default: <code class="docutils literal notranslate"><span class="pre">&quot;ingoing&quot;</span></code></p></li>
<li><p><strong>count_flows</strong> (<em>bool</em>) – Count the number of flows instead of volume. If set, <code class="docutils literal notranslate"><span class="pre">&quot;volume_direction&quot;</span></code> is ignored.
Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – The privacy budget to allocate for the query. Default: <code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The volume in bytes of number of flows</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dpmon.DPMon.volume_on_domain">
<span class="sig-name descname"><span class="pre">volume_on_domain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ingoing'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dpmon.DPMon.volume_on_domain" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the traffic volume to/from a specific domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – The domain name to query</p></li>
<li><p><strong>volume_direction</strong> (<em>str</em>) – Whether to compute ingress (<code class="docutils literal notranslate"><span class="pre">&quot;ingoing&quot;</span></code>) or egress (<code class="docutils literal notranslate"><span class="pre">&quot;outgoing&quot;</span></code>) volume, in bytes.
Default: <code class="docutils literal notranslate"><span class="pre">&quot;ingoing&quot;</span></code></p></li>
<li><p><strong>count_flows</strong> (<em>bool</em>) – Count the number of flows instead of volume. If set, <code class="docutils literal notranslate"><span class="pre">&quot;volume_direction&quot;</span></code> is ignored.
Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – The privacy budget to allocate for the query. Default: <code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The volume in bytes of number of flows</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dpmon.DPMon.volume_on_domain_pattern">
<span class="sig-name descname"><span class="pre">volume_on_domain_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ingoing'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dpmon.DPMon.volume_on_domain_pattern" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the traffic volume to/from a specific domain pattern.
The function searches for flows to a domain that matches the given pattern.
Pattern are defined in the SQL style, thus for example the <code class="docutils literal notranslate"><span class="pre">%</span></code> character represents any string of zero or more characters,
while <code class="docutils literal notranslate"><span class="pre">_</span></code> represents any single character. 
This function is useful to obtain the traffic volume by second level domain, e.g., <code class="docutils literal notranslate"><span class="pre">%.googlevideo.com</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pattern</strong> (<em>str</em>) – The domain pattern (in SQL syntax) to query</p></li>
<li><p><strong>volume_direction</strong> (<em>str</em>) – Whether to compute ingress (<code class="docutils literal notranslate"><span class="pre">&quot;ingoing&quot;</span></code>) or egress (<code class="docutils literal notranslate"><span class="pre">&quot;outgoing&quot;</span></code>) volume, in bytes.
Default: <code class="docutils literal notranslate"><span class="pre">&quot;ingoing&quot;</span></code></p></li>
<li><p><strong>count_flows</strong> (<em>bool</em>) – Count the number of flows instead of volume. If set, <code class="docutils literal notranslate"><span class="pre">&quot;volume_direction&quot;</span></code> is ignored.
Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – The privacy budget to allocate for the query. Default: <code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The volume in bytes of number of flows</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dpmon.DPMon.volume_on_ip">
<span class="sig-name descname"><span class="pre">volume_on_ip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ingoing'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dpmon.DPMon.volume_on_ip" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the traffic volume to/from a specific external IP address</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ip</strong> (<em>str</em>) – The IP address to query</p></li>
<li><p><strong>volume_direction</strong> (<em>str</em>) – Whether to compute ingress (<code class="docutils literal notranslate"><span class="pre">&quot;ingoing&quot;</span></code>) or egress (<code class="docutils literal notranslate"><span class="pre">&quot;outgoing&quot;</span></code>) volume, in bytes.
Default: <code class="docutils literal notranslate"><span class="pre">&quot;ingoing&quot;</span></code></p></li>
<li><p><strong>count_flows</strong> (<em>bool</em>) – Count the number of flows instead of volume. If set, <code class="docutils literal notranslate"><span class="pre">&quot;volume_direction&quot;</span></code> is ignored.
Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – The privacy budget to allocate for the query. Default: <code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The volume in bytes of number of flows</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dpmon.html" class="btn btn-neutral float-left" title="dpmon" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Martino Trevisan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>